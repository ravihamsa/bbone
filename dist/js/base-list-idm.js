/**
 * @license RequireJS text 2.0.5+ Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

define("base/util",[],function(){var e=function(e){if(!e)return{};var t=_.map(e.split(";"),function(e){return e.split("=")}),n={};return _.each(t,function(e){n[e[0]]=e[1]}),n},t=function(e,t){var n=[];return t=t||";",_.each(e,function(e,t){n.push(t+"="+e)}),n.join(t)},n=function(e,t){var n=t.parentView;e&&(n&&n.addChildView(e),t.skipRender!==!0&&e.render(),t.parentEl!==undefined?(t.replaceHTML===!0&&t.parentEl.empty(),n&&n.$(t.parentEl).length>0?e.$el.appendTo(n.$(t.parentEl)):e.$el.appendTo(t.parentEl)):e.$el.appendTo(n.el))};return{paramsToObject:e,objectToParams:t,createView:function(e){var t,r="model";if(e.collection||e.Collection)r="collection";r==="model"?e.Model&&(e.model=new e.Model(e.modelAttributes)):e.Collection&&(e.collection=new e.Collection(e.items));var i=_.omit(e,"Collection","Model","parentEl","skipRender","View");return t=new e.View(i),n(t,e),t},deployView:n}}),define("base/router",["require","base/util"],function(e){var t=e("base/util"),n=Backbone.Router.extend({routes:{"":"index",":appId/:pageId/*params":"loadAppPage",":appId/":"loadApp",":appId":"loadApp",":appId/:pageId":"loadAppPage",":appId/:pageId/":"loadAppPage"},index:function(){e(["base/app"],function(e){e.router.navigate("#"+e.defaultApp,{trigger:!0})})},loadAppPage:function(n,r,i){e(["base/app"],function(e){var s=t.paramsToObject(i);s.appId=n,s.pageId=r,e.appModel.reset(s)})},loadApp:function(n,r,i){e(["base/app"],function(e){var r=t.paramsToObject(i),s=e.appModel;r.appId=n,e.appModel.reset(r)})}});return n}),define("base/dataLoader",["require"],function(e){var t={},n={},r={type:"get",params:{},url:"",parser:_.identity};n.define=function(e,n){var i=_.extend({},r,n);t[e]=i};var i=n.getConfig=function(e){if(t[e])return _.clone(t[e]);throw Error("Undefined request by Id: "+e)};return n.getRequest=function(e,t){var n=i(e,t),r=$.extend(!0,{},n);return n.type.toLowerCase()==="post"?(r.data=JSON.stringify(t),$.ajax(r)):n.type.toLowerCase()==="form_post"?$.post(r.url,t):(_.isEmpty(t)||(r.url+="?"+$.param(t)),$.ajax(r))},n}),define("base/bareModel",[],function(){var e=Backbone.Model.extend({reset:function(e,t,n){var r,i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,u=n.silent,o=[],a=this._changing,this._changing=!0,a||(this._previousAttributes=_.clone(this.attributes),this.changed={}),l=this.attributes,f=this._previousAttributes,c=_.omit(this._previousAttributes,_.keys(i)),this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in c)t=i[r],_.isEqual(l[r],t)||o.push(r),_.isEqual(f[r],t)?delete this.changed[r]:this.changed[r]=t,delete l[r];for(r in i)t=i[r],_.isEqual(l[r],t)||o.push(r),_.isEqual(f[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete l[r]:l[r]=t;if(!u){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,l[o[h]],n)}if(a)return this;if(!u)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this}});return e}),define("base/mixins/config",["base/bareModel"],function(e){var t=function(e,t){_.each(e,function(e,n){var r=this[n+"ConfigHandler"];r&&typeof r=="function"&&r.call(this,e,t),this.trigger("configChange:"+n,e)},this);var n=this.configHandler;n&&typeof n=="function"&&n.call(this,e,t),this.trigger("configChange",e)},n=function(n){var r=n.getOption("configs"),i=n.getOption("configDefaults");r=_.extend({},i,r);if(!_.isEmpty(r)){var s=new e(r);n.setConfig=function(e,t){s.set(e,t)},n.setConfigs=function(e){s.set(e)},n.getConfigs=function(){return s.toJSON()},n.resetConfigs=function(e){s.reset(e)},n.getConfig=function(e){return s.get(e)};var o=function(){t.call(n,s.toJSON(),!0),n.listenTo(s,"change",function(){t.call(n,s.changedAttributes())})};n instanceof Backbone.View&&!n.getOption("preRendered")?n.listenToOnce(n,"rendered",o):o()}};return n}),define("base/model",["base/bareModel","base/mixins/config"],function(e,t){var n=e.extend({constructor:function(e,n){var r=this;r.options=n||{},n&&n.defaults&&(r.defaults=n.defaults),Backbone.Model.apply(r,arguments,n),t.call(null,r)},is:function(e){return this.get(e)===!0},isNot:function(e){return this.get(e)===!1},isEqual:function(e,t){return this.get(e)===t},isNotEqual:function(e,t){return this.get(e)!==t},removeSelf:function(){this.collection&&this.collection.remove(this)},insertAfter:function(e){var t=this.collection,n=t.indexOf(this);return t.add(e,{at:n+1}),t.at(n+1)},isDefault:function(e,t){return this.defaults[e]===t},setDefault:function(e,t){this.defaults[e]=t},next:function(){var e=this.collection;if(!e)return;var t=e.indexOf(this);if(t===e.length-1)return;return e.at(t+1)},index:function(){var e=this.collection;return e?e.indexOf(this):0},moveUp:function(){var e=this.collection;if(!e)return;var t=e.indexOf(this);if(t===0)return;this.removeSelf(),e.add(this,{at:t-1})},moveDown:function(){var e=this.collection;if(!e)return;var t=e.indexOf(this);if(t===e.length-1)return;this.removeSelf(),e.add(this,{at:t+1})},getClosest:function(){var e=this.collection;if(!e||e.length<2)return;var t=e.indexOf(this),n=e.at(t-1);return n?n:e.at(t+1)},toJSON:function(e){var t=_.clone(this.attributes);return e&&_.each(t,function(e,n){e.toJSON&&(t[n]=e.toJSON())}),t},checkFilters:function(e){if(e.length===0)return!0;var t=this,n=t.toJSON(),i=_.every(e,function(e){return r[e.expr].call(t,e,n[e.column])});return i},getOption:function(e){return this.options[e]||this[e]},reset:function(e,t,n){var r,i,s,o,u,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,u=n.silent,o=[],a=this._changing,this._changing=!0,a||(this._previousAttributes=_.clone(this.attributes),this.changed={}),l=this.attributes,f=this._previousAttributes,c=_.omit(this._previousAttributes,_.keys(i)),this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in c)t=i[r],_.isEqual(l[r],t)||o.push(r),_.isEqual(f[r],t)?delete this.changed[r]:this.changed[r]=t,delete l[r];for(r in i)t=i[r],_.isEqual(l[r],t)||o.push(r),_.isEqual(f[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete l[r]:l[r]=t;if(!u){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,l[o[h]],n)}if(a)return this;if(!u)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this}}),r={eq:function(e,t){return e.value===t},startsWith:function(e,t){return(new RegExp("^"+e.value,"i")).test(t)},endsWith:function(e,t){return(new RegExp(e.value+"$","i")).test(t)},has:function(e,t){return(new RegExp(e.value,"i")).test(t)}};return n}),define("base/app",["require","base/router","base/dataLoader","base/util","base/model"],function(e,t,n,r,i){function o(e){var t,n=305419896;for(t=0;t<e.length;t++)n+=e.charCodeAt(t)*t;return n}$.browser={msie:!1},$.ajaxSetup({cache:!1});var s=window.hex_md5,u=function(e){return o(e.toString())},a=function(e){return c[e]},f=function(e){return h[e]},l=1,c={},h={},p={},d={root:"/",baseUrl:"js/",defaultApp:"default",appBody:"#app-body",compileTemplate:function(e){return Handlebars.compile(e)},router:new t,getTemplateDef:function(t,n){var r=this;t=t||"";var i=u(t),s=n!=="underscore"?r.compileTemplate:_.template,o=a(i);return o||(o=$.Deferred(),typeof t=="function"?o.resolve(t):typeof t=="string"&&(r.cacheTemplate(o,i),/html$/.test(t)?e(["text!"+t],function(e){o.resolve(s(e))}):t.indexOf("#")===0?o.resolve(s($(t).html())):o.resolve(s(t)))),o},cacheTemplate:function(e,t){c[t]=e},cacheData:function(e,t){h[t]=e},log:function(){console.log.apply(console,arguments)},responseParser:function(e){return e},appModel:new i,getRequestDef:function(e){var t=this,r=n.getConfig(e.id);r.paramsParser=r.paramsParser||_.identity;var i=t.responseParser;r.responseParser&&(i=r.responseParser),e.params=r.paramsParser(e.params);var s=u(JSON.stringify(_.pick(e,"id","params"))),o=f(s);if(!o){o=$.Deferred();var a=n.getRequest(e.id,e.params);a.done(function(n){var r=i(n);r.errors?o.reject(n,r.errors):(e.cache==="session"&&t.cacheData(o,s),o.resolve(r))}),a.fail(function(e){o.resolve({errors:[{errorCode:"network issue",message:"Network failure try again later"}]})})}return o},beautifyId:function(e){return e=e.replace(/_([a-z])/g,function(e){return e.toUpperCase()}),e=e.replace(/_/g,""),e=e.replace(/([A-Z])/g,function(e){return" "+e}),e.replace(/(^.)/g,function(e){return e.toUpperCase()})},getDataIndex:function(){return h},getTemplateIndex:function(){return c},getFormatted:function(e,t,n){if(typeof t=="function")return t.apply(null,arguments);var r=v[t];return r?r(e,n):e},addFormatter:function(e,t){if(v[e])throw new Error("formatter already exist");this.setFormatter.apply(null,arguments)},setFormatter:function(e,t){v[e]=t},updateStringIndex:function(e){p=_.extend({},p,e)},getString:function(e){return p[e]?p[e]:e},getPageAttribute:function(e){return this.appModel.get(e)},getPageAttributes:function(){return this.appModel.toJSON()},getHash:u,getUniqueId:function(){return"__tmp_"+l++},setupApp:function(e){e()},tearApp:function(e){e&&e()},navigateTo:function(e,t,n){d.router.navigate(this.getURL(e,t,n),{trigger:!0})},getURL:function(e,t,n){var i="#";return e&&(i+=e),t&&(i+="/"+t),n&&(i+="/"+r.objectToParams(_.omit(n,"appId","pageId"))),i}};_.extend(d,Backbone.Events);var v={};return $("body").on("click",".dummy",function(e){e.preventDefault(),console.warn("dummy click prevented")}),$("body").on("click",function(e){var t=$(e.target);if(t.parents().index(this)===-1&&!t.is(this))return;d.trigger("bodyClick",e)}),d}),define("base/view",["base/app","base/model","base/util","base/mixins/config"],function(e,t,n,r){var i=Backbone.View.extend({constructor:function(e){var t=this;t.removeQue=[],t.removed=!1,t.rendered=!1,Backbone.View.call(t,e),_.each(y,function(e){e(t)})},setupView:function(){},tearUpView:function(){},postSetup:function(){},postMetaLoad:function(){},render:function(){var n=this;n.$el.addClass("rendering"),n.model||(n.model=new t);var r=(new Date).getTime();n.beforeRender();var i=g(n,function(){n.removeChildViews&&n.removeChildViews(),e.getTemplateDef(n.getTemplate(),n.getTemplateType()).done(g(n,function(e){n.renderTemplate(e),f(n);if(n.setState){n.clearState();var t=_.keys(n.getOption("states"))[0];n.setState(n.getState()||n.getOption("state")||t)}n.postRender(),n.$el.removeClass("rendering");var i=(new Date).getTime()-r;i>20&&console.warn(this.$el[0],i),n.rendered=!0,n.trigger("rendered")}))}),s=function(){n.postMetaLoad.apply(n,arguments),i()};if(!n.rendered){var o=n.loadMeta();o.done(g(n,s))}else i();return n},postRender:function(){},beforeRender:function(){},renderTemplate:function(e){this.$el.html(e(this.serialize()))},getOption:function(e){return this.options[e]||this[e]},loadingHandler:function(e){this.$el.toggleClass("loading",e)},metaLoadErrorHandler:function(){this.$el.html("Error Loading Meta Data")},addMethod:function(e,t){this[e]||(this[e]=t)},serialize:function(){var e=this.getOption("useDeepJSON");return this.model.toJSON(e)},remove:function(){this.removeChildViews(),Backbone.View.prototype.remove.call(this),this.removeReferences(),this.stopListening(),this.removeQue=null,this.removed=!0},removeReferences:function(e){e?this.removeQue.push(e):_.each(this.removeQue,function(e){e.call(this)})},show:function(){this.$el.show()},hide:function(){this.$el.hide()},postMessage:function(){var e=_.toArray(arguments);e.unshift("all"),e.unshift("postMessage"),this.trigger.apply(this,e)},postMessageTo:function(e){var t=_.rest(arguments);t.unshift(e),t.unshift("postMessage"),this.trigger.apply(this,t)}});i.deepExtendMethods=function(e){var t=this.prototype;_.each(e,function(e,n){var r=t[n];if(!r)throw new Error("Method with name: "+n+" doesn't exists to deep extend");t[n]=function(){r.apply(this,arguments),e.apply(this,arguments)}})},i.templateTypes={UNDERSCORE:"underscore",HANDLEBARS:"handlebars"};var s=function(e){var t=e.model||e.collection,n;n=e.dataEvents,_.each(n,function(n,r){var i,s,o;o=/\s+/,s=n.split(o),i=r.split(o),_.each(s,function(n){_.each(i,function(r){e.listenTo(t,r,function(){if(!e[n])throw n+" Not Defined";var t=Array.prototype.slice.call(arguments);t.unshift(r),e[n].apply(e,t)})})})})},o=function(e){var t;t=e.customEvents,_.each(t,function(t,n){var r,i,s;s=/\s+/,i=t.split(s),r=n.split(s),_.each(i,function(t){_.each(r,function(n){e.listenTo(e,n,function(){if(!e[t])throw t+" Not Defined";var n=Array.prototype.slice.call(arguments);e[t].apply(e,n)})})})})},u=function(e){var t=e.getOption("states");if(!t)return;var r,i,s=function(){i&&i.remove()},o=function(t){if(e.$(".state-view").length===0)throw new Error('Rendering state needs element with class "state-view".');i=n.createView({View:t,model:e.model,parentEl:".state-view",parentView:e}),e.listenTo(i,"setState",function(t){e.setState(t)})};e.setState=function(e){if(typeof e!="string")throw new Error("state should be a string");if(r===e)return;r=e;var n=t[e];if(!n)throw new Error("Invalid State");s(),o(n)},e.getState=function(){return r},e.clearState=function(){s(),r=undefined},e.removeReferences(function(){t=null,r=null,i=null,e=null})},a=function(e){var t=e.getOption("template")||e.template;e.setTemplate=function(n){t=n,e.render()},e.getTemplate=function(){return t},e.getTemplateType=function(){return e.getOption("templateType")||"Handlebars"},e.removeReferences(function(){t=null,e=null})},f=function(e){var t={},r=e.getOption("views");e.getSubView=function(e){var n=t[e];if(n)return n;throw new Error("No View Defined for id :"+e)},e.setSubView=function(n,r){t[n]=r,e.addToMessageRoom(r,n)},e.getAllSubViews=function(){return t},e.getSubCollection=function(t){return e.getSubView(t).collection},e.getSubModel=function(t){return e.getSubView(t).model},e.getSubAttribute=function(t,n){return e.getSubModel(t).get(n)},e.removeReferences(function(){r=null,t=null,e=null}),e.addToMessageRoom(e,"owner"),_.each(r,function(t,r){typeof t=="function"&&(t=t.call(e)),t.parentView=e;var i=n.createView(t);e.setSubView(r,i)})},l=function(e){var t=e.model,n=e.getOption("preRendered"),r=function(){c.call(e,t.toJSON(),!0),e.listenTo(t,"change",function(){c.call(e,t.changedAttributes())})};t&&(n?r():e.listenToOnce(e,"rendered",r))},c=function(e,t){_.each(e,function(e,n){var r=this[n+"ChangeHandler"];r&&typeof r=="function"&&r.call(this,e,t)},this);var n=this.changeHandler;n&&typeof n=="function"&&n.call(this,e,t)},h=function(e){var t=function(e){e.actionHandled&&(e.stopPropagation(),$("body").trigger("click"))};e.actionHandler&&e.$el.on("click",".action",function(n){n.preventDefault();var r=$(n.currentTarget),i=r.attr("href").substr(1);e.actionHandler.call(e,i,n),t(n)}),e.$el.on("click",".dummy",function(e){e.preventDefault()}),e.removeReferences(function(){e.$el.off(),e=null})},p=function(e){var t=e.getOption("renderEvents")||e.renderEvents;t&&t.length>0&&e.listenTo(e.model,t.join(" "),function(){e.render.call(e)})},d=function(t){var n=t.getOption("requests")||t.requests,r=0,i=g(t,function(){r++,r>0&&t.loadingHandler.call(t,!0)}),s=g(t,function(){r--,r<1&&t.loadingHandler.call(t,!1)});t.addRequest=function(t,n){var r=t;_.isArray(r)||(r=[r]);var o=_.map(r,function(t){var n=e.getRequestDef(t);return t.callback&&n.always(t.callback),i(),n.always(s),n}),u=$.when.apply(null,o);return n&&u.then(n),u},t.loadMeta=function(){if(!t.metaDef){var e=n?t.addRequest(n,g(t,function(){var e=t.getOption("requestsParser");e&&e.apply(t,arguments)})):$.when({});t.metaDef=e}return t.metaDef},t.removeReferences(function(){n=null,r=null,t=null})},v=function(e){var t=[];e.addChildView=function(e){t.push(e)},e.removeChildViews=function(){_.each(t,function(e){e.parentView=null,e&&e.remove&&e.remove()}),t=[]},e.removeReferences(function(){t=null,e=null})},m=function(e){var t={};e.addToMessageRoom=function(n,r){t[r]=n,e.listenTo(n,"postMessage",function(){var e=_.first(arguments),i="message",s=_.rest(arguments);s.unshift(n),s.unshift(r),s.unshift(i);if(e==="all")_.each(t,function(e,t){r!==t&&e.trigger.apply(e,s)});else{var o=t[e];o&&o.trigger.apply(o,s)}})},e.removeReferences(function(){t=null,e=null})},g=function(e,t){return function(){e.removed||t.apply(e,arguments)}},y=[s,o,m,d,a,l,h,p,u,v,r];return i}),define("text",["module"],function(e){var t,n,r,i,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,a=typeof location!="undefined"&&location.href,f=a&&location.protocol&&location.protocol.replace(/\:/,""),l=a&&location.hostname,c=a&&(location.port||undefined),h=[],p=e.config&&e.config()||{};t={version:"2.0.5+",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(u);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(r){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,p.isBuild&&(h[e]=r),i(r)},load:function(e,n,r,i){if(i.isBuild&&!i.inlineText){r();return}p.isBuild=i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),h=p.useXhr||t.useXhr;!a||h(u,f,l,c)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(h.hasOwnProperty(n)){var s=t.jsEscape(h[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(p.env==="node"||!p.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node)n=require.nodeRequire("fs"),t.get=function(e,t){var r=n.readFileSync(e,"utf8");r.indexOf("﻿")===0&&(r=r.substring(1)),t(r)};else if(p.env==="xhr"||!p.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);p.onXhr&&p.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r(o)):n(s.responseText))},s.send(null)};else if(p.env==="rhino"||!p.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(p.env==="xpconnect"||!p.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var n,s,o={},u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),s.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),o),s.close(),n.close(),t(o.value)}catch(a){throw new Error((u&&u.path||"")+": "+a)}};return t}),define("text!widgets/header/header.html",[],function(){return'<div class="container">\n    <a href="#" class="logo"><img src="/ibone/js/widgets/header/inmobi-logo.png"/> </a>\n    <ul class="nav-items">\n        <li class="introduction"><a href="#introduction/landing">Introduction</a></li>\n        <li class="examples"><a href="#examples/landing">Examples</a></li>\n    </ul>\n</div>'}),define("widgets/header",["base/view","base/model","text!./header/header.html"],function(e,t,n){var r=e.extend({template:n,appIdChangeHandler:function(e){this.$(".active").removeClass("active"),this.$("."+e).addClass("active")}});return{View:r,Model:t}}),define("base/root",["base/view","base/app","widgets/header"],function(e,t,n){var r,i,s=function(e,n,i){console.log("renderPage",e,n,i),r&&r.remove(),require(["apps/"+e+"/pages/"+n],function(e){var n=new e.View({model:new e.Model(i)}),s=$(t.appBody);s.empty(),s.html(n.el),n.render(),r=n})},o=e.extend({postRender:function(){var e=new n.View({el:this.$("#header"),model:this.model});e.render()},changeHandler:function(e){var t=this,n=t.model.toJSON();console.log(e),e.hasOwnProperty("appId")?require(["apps/"+n.appId],function(){require(["apps/"+n.appId+"/app"],function(e){i&&i.tearApp(),e.setupApp(function(){n.hasOwnProperty("pageId")?s(n.appId,n.pageId,n):t.model.set("pageId",e.defaultPage)}),i=e})}):e.hasOwnProperty("pageId")?require(["apps/"+n.appId+"/app"],function(r){e.pageId===undefined?(t.model.set("pageId",r.defaultPage),n=t.model.toJSON()):s(n.appId,n.pageId,n)}):r&&r.model.reset(n)},preRendered:!0});return{View:o}}),define("base/itemView",["base/view"],function(e){var t=e.extend({tagName:"li",template:"{{name}}"});return t}),define("base/collectionView",["base/view","base/itemView","base/util"],function(e,t,n){var r=function(){var e=this,r={},i=this.$el,s=this.collection;e.addItem=function(o,u){u||(u=i);var a=s.indexOf(o),f=e.getOption("ItemView")||t,l=n.createView({model:o,attributes:{"data-id":o.id},View:f,parentView:e});r[o.cid]=l;if(a===0)l.$el.prependTo(u);else if(a>=s.length-1)l.$el.appendTo(u);else{var c=e.getModelViewAt(s.at(a-1).cid);l.$el.insertAfter(c.$el)}},e.removeItem=function(t){var n=e.getModelViewAt(t.cid);delete r[t.cid],n.remove()},e.removeAllItems=function(){_.each(r,function(e){e.remove()}),r={}},e.getModelViewAt=function(e){return r[e]},s.length>0&&e.on("rendered",e.renderItems),e.removeReferences(function(){e=null,r=null,i=null,s=null})},i=e.extend({constructor:function(t){var n=this;e.call(n,t),_.each([r],function(e){e.call(n,t)})},tagName:"ul",dataEvents:{add:"addHandler",remove:"removeHandler",reset:"resetHandler"},resetHandler:function(e,t,n){var r=this;_.each(n.previousModels,function(e){r.removeItem(e)}),r.renderItems()},renderItems:function(){var e=this;e.removeAllItems();var t=this.$el,n=this.collection;n.each(function(n){e.addItem(n,t)})},addHandler:function(e,t){this.addItem(t)},removeHandler:function(e,t){this.removeItem(t)}});return i}),define("base/collection",["base/app","base/model","base/mixins/config"],function(e,t,n){var r=Backbone.Collection.extend({model:t,constructor:function(e,t){var r=this;r.options=t||{},arguments[1]=_.omit(t,"configs"),Backbone.Collection.apply(r,arguments),n.call(null,r)},getOption:function(e){return this.options[e]||this[e]}});return r}),define("base/helpers",["base/app"],function(e){Handlebars.registerHelper("elementLabel",function(e){return e.label||e.name}),Handlebars.registerHelper("string",function(t){return e.getString(t)}),Handlebars.registerHelper("stringify",function(e){return JSON.stringify(e)}),Handlebars.registerHelper("toString",function(e){return e.toString()}),Handlebars.registerHelper("formLabel",function(t){return e.getString("form.label."+t)}),Handlebars.registerHelper("toggleClass",function(e){if(this[e])return e}),Handlebars.registerHelper("buttonType",function(){return this.isPrimary?"submit":"button"}),Handlebars.registerHelper("buttonClass",function(){return this.isPrimary?"btn-primary-cta":this.isSecondary?"btn-secondary-cta":"btn-regular"}),Handlebars.registerHelper("ifEqual",function(e,t,n){if(e===t)return n.fn(this);if(n.inverse)return n.inverse(this)})}),define("base/formatter",[],function(){require(["base/app"],function(e){function t(e,t){try{for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}catch(r){e.prototype=t}}function i(e){return e}function s(){}function c(e,t){var n=Math.pow(10,Math.abs(8-t)*3);return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function d(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function v(e){return e+""}var n="\0",r=n.charCodeAt(0);e.map=function(e){var t=new s;if(e instanceof s)e.forEach(function(e,n){t.set(e,n)});else for(var n in e)t.set(n,e[n]);return t},t(s,{has:function(e){return n+e in this},get:function(e){return this[n+e]},set:function(e,t){return this[n+e]=t},remove:function(e){return e=n+e,e in this&&delete this[e]},keys:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},values:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e},entries:function(){var e=[];return this.forEach(function(t,n){e.push({key:t,value:n})}),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===r&&e.call(this,t.substring(1),this[t])}});var o=".",u=",",a=[3,3],f="$",l=_.map(["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],c);e.formatPrefix=function(t,n){var r=0;return t&&(t<0&&(t*=-1),n&&(t=e.round(t,d(t,n))),r=1+Math.floor(1e-12+Math.log(t)/Math.LN10),r=Math.max(-24,Math.min(24,Math.floor((r<=0?r+1:r-1)/3)*3))),l[8+r/3]},e.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},e.format=function(t){var n=h.exec(t),r=n[1]||" ",i=n[2]||">",s=n[3]||"",u=n[4]||"",a=n[5],l=+n[6],c=n[7],d=n[8],g=n[9],y=1,b="",w=!1;d&&(d=+d.substring(1));if(a||r==="0"&&i==="=")a=r="0",i="=",c&&(l-=Math.floor((l-1)/4));switch(g){case"n":c=!0,g="g";break;case"%":y=100,b="%",g="f";break;case"p":y=100,b="%",g="r";break;case"b":case"o":case"x":case"X":u==="#"&&(u="0"+g.toLowerCase());case"c":case"d":w=!0,d=0;break;case"s":y=-1,g="r"}u==="#"?u="":u==="$"&&(u=f),g=="r"&&!d&&(g="g");if(d!=null)if(g=="g")d=Math.max(1,Math.min(21,d));else if(g=="e"||g=="f")d=Math.max(0,Math.min(20,d));g=p.get(g)||v;var E=a&&c;return function(t){if(w&&t%1)return"";var n=t<0||t===0&&1/t<0?(t=-t,"-"):s;if(y<0){var f=e.formatPrefix(t,d);t=f.scale(t),b=f.symbol}else t*=y;t=g(t,d);var h=t.lastIndexOf("."),p=h<0?t:t.substring(0,h),v=h<0?"":o+t.substring(h+1);!a&&c&&(p=m(p));var S=u.length+p.length+v.length+(E?0:n.length),x=S<l?(new Array(S=l-S+1)).join(r):"";return E&&(p=m(x+p)),n+=u,t=p+v,(i==="<"?n+t+x:i===">"?x+n+t:i==="^"?x.substring(0,S>>=1)+n+t+x.substring(S):n+(E?t:x+t))+b}};var h=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,p=e.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(t,n){return(t=e.round(t,d(t,n))).toFixed(Math.max(0,Math.min(20,d(t*(1+1e-15),n))))}}),m=i;if(a){var g=a.length;m=function(e){var t=e.length,n=[],r=0,i=a[0];while(t>0&&i>0)n.push(e.substring(t-=i,t+i)),i=a[r=(r+1)%g];return n.reverse().join(u)}}e.addFormatter("currency",e.format("$0,000")),e.addFormatter("integer",e.format("0,000"))})}),define("base",["require","base/view","base/root","base/collectionView","base/itemView","base/model","base/collection","base/util","base/app","base/dataLoader","base/router","base/helpers","base/formatter"],function(e){return{View:e("base/view"),Root:e("base/root"),CollectionView:e("base/collectionView"),ItemView:e("base/itemView"),Model:e("base/model"),Collection:e("base/collection"),util:e("base/util"),app:e("base/app"),dataLoader:e("base/dataLoader"),Router:e("base/router"),helpers:e("base/helpers"),formatter:e("base/formatter")}}),define("widgets/form/validator",["base/app"],function(e){var t=function(e,t){var r=[],i,s=_.every(t,function(t){var s=n[t.expr].call(this,t,e);return s||(r.push(t),i=t),s});return{isValid:s,errors:r,errorRule:i}},n={req:function(e,t){return!_.isEmpty(t)},digits:function(e,t){return/^\d{5}$/.test(t)},alphanumeric:function(e,t){var n=/^\w+$/;return n.test(t)},number:function(e,t){if(t===undefined)return!0;var n=+t;return n===n},email:function(e,t){var n=/^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-\\+]+)*@[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-\+]+)*(\.[A-Za-z]{2,})$/i;return n.test($.trim(t))},minlen:function(e,t){var n=e.length;return $.trim(String(t)).length>=n},maxlen:function(e,t,n){var r=e.length;return $.trim(String(t)).length<=r},lt:function(e,t,n){var r=parseFloat(n),i=parseFloat(t);return i<r},gt:function(e,t,n){var r=parseFloat(n),i=parseFloat(t);return i>r},eq:function(e,t,n){return n===t},neq:function(e,t){return e.value!==t},url:function(e,t){if(t==="")return!0;var n=/(http|https|market):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/i;return n.test($.trim(t))},emaillist:function(e,t){var n=t.split(","),r=/^([\w\-]+(?:\.[\w\-]+)*)@((?:[\w\-]+\.)*\w[\w\-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;for(var i=0;i<n.length;i++)if($.trim(n[i])!==""&&!r.test($.trim(n[i])))return!1;return!0},"function":function(e,t){var n=e.func;return n.call(null,t)}};return{validateValue:t,validationRuleMethods:n}}),define("text!widgets/form/inputView.html",[],function(){return'<div class="form-group">\n    <label>{{elementLabel this}}</label>\n    <div class="controls">\n        <input type="{{type}}" placeholder="{{placeholder}}"  name="{{name}}"  value="{{value}}" class="el-{{name}} form-control js-validate-change">\n        <span class="message-block"></span>\n    </div>\n</div>'}),define("widgets/form/element",["base/app","base","widgets/form/validator","text!./inputView.html"],function(e,t,n,r){var i=".form-group",s=".message-block",o="has-error",u=t.Model.extend({constructor:function(){t.Model.apply(this,arguments);var e=this,n=e.get("defaultValue");n===undefined&&e.set("defaultValue",e.get("value"));var r=e.collection,i=e.get("activeRules");_.each(i,function(t){var n=r.get(t.element);n.on("change:value",function(t,n){e.updateActive()}),e.updateActive()})},defaults:{valid:!0,active:!0,disabled:!1,readonly:!1,value:null,label:null,activeRules:[],validationRules:[],type:"text",errorCode:"",group:"elements"},idAttribute:"name",updateActive:function(){var e=this.get("activeRules"),t=_.every(e,function(e){var t=this.collection.get(e.element);return l[e.expr].call(this,t,e)},this);this.set("active",t)},isElementValid:function(e){var t=this.get("validationRules"),r=[];if(this.isNot("active"))return[];var i,s=_.every(t,function(e){var t=n.validationRuleMethods[e.expr].call(this,e,this.get("value"));return t||(r.push(e),i=e),t},this);this.set("valid",s);if(!e)if(i){var o=i.message||"error."+this.get("name")+"."+i.expr;this.set("errorCode",o)}else this.set("errorCode","");return r},getSiblingValue:function(e){if(this.collection)return this.collection.get(e).get("value")},getSiblingAttribute:function(e,t){if(this.collection)return this.collection.get(e).get(t)},setSiblingAttribute:function(e,t,n){if(this.collection)return this.collection.get(e).set(t,n)},setSiblingValue:function(e,t){if(this.collection)return this.collection.get(e).set("value",t)},isElementDefault:function(){var e=this.toJSON();return e.value===e.defaultValue},resetValue:function(e){var t=this;t.set("value",t.get("defaultValue")),this.updateActive(),e&&t.set("errorCode","")}}),a=t.Collection.extend({model:u}),f=t.View.extend({tagName:"div",className:"element",template:r,dataEvents:{forceRender:"render",forceUpdate:"updateValue"},events:{"change input":"updateValue","blur input":"updateValue","change select":"updateValue","blur select":"updateValue","change textarea":"updateValue","blur textarea":"updateValue","change .js-validate-change":"validateValue","blur .js-validate-blur":"validateValue","keyup .js-update-keyup":"updateValue"},postRender:function(){this.syncAttributes()},syncAttributes:function(){var e=this.model,t=e.toJSON();_.each(t,function(t,n){var r=this[n+"ChangeHandler"];r&&typeof r=="function"&&r.call(this,e.get(n))},this),this.updateValue(!0)},disabledChangeHandler:function(e){this.$el.toggleClass("disabled",e),this.$("input").attr("disabled",e)},readonlyChangeHandler:function(e){this.$el.toggleClass("readonly",e),this.$("input").attr("readonly",e)},validChangeHandler:function(e){this.$(i).toggleClass(o,!e)},activeChangeHandler:function(e){this.$el.toggle(e)},valueChangeHandler:function(e){this.$("input").val(e),this.model.updateActive()},errorCodeChangeHandler:function(t){var n=this.$(s);t===""?(n.empty(),this.model.set("valid",!0)):(this.model.set("valid",!1),n.html(e.getString(t)))},nameChangeHandler:function(e){this.$el.addClass("element-"+e)},valueFunction:function(){return this.$("input").val()},updateValue:function(e){this.model.set("value",this.valueFunction())},validateValue:function(){this.model.isElementValid()}}),l={eq:function(e,t){return e.isEqual("value",t.value)},valid:function(e){return e.isElementValid(!0),e.is("valid")},isIn:function(e,t){var n=e.get("value");return t.value.indexOf(n)!==-1},neq:function(e,t){return e.isNotEqual("value",t.value)},"function":function(e,t){var n=t.func;return n.apply(this,arguments)}};return{View:f,Model:u,Collection:a}}),define("list/singleSelect",["base"],function(e){function a(e){var t,n,r=e.get("items");r||(r=new s,e.set("items",r));var i=r.findWhere({selected:!0});i&&(t=i,n=i);var o=function(){e.set("selectedItem",t)};e.getSelected=function(){return t},e.getSelectedIndex=function(){return t!==undefined?r.indexOf(t):-1},e.prevSelected=function(){return n},e.setSelectedById=function(e){var i=r.get(e);if(!t){t=i,i.select(),o();return}if(i.id===t.id)return;n=t,t=i,n.deselect(),i.select(),o()},e.setSelected=function(e){if(!e){o();return}if(!t){t=e,e.select(),o();return}if(e.id===t.id)return;n=t,t=e,n.deselect(),e.select(),o()},e.clearSelection=function(){n=t,t=null,n.deselect(),o()},e.selectFirst=function(){e.setSelected(r.first())},e.selectAt=function(t){r.at(t)?e.setSelected(r.at(t)):e.selectFirst()}}var t=e.util,n=e.View.extend({template:'<div class="list-view"></div>',postRender:function(){var n=this,r=this.model.get("items"),s=t.createView({View:e.CollectionView,collection:r,parentEl:n.$(".list-view"),ItemView:n.getOption("ItemView")||i,parentView:n})},actionHandler:function(e){this.model.setSelectedById(e)}}),r=e.Model.extend({defaults:{selected:!1},select:function(){this.set("selected",!0)},deselect:function(){this.set("selected",!1)},toggleSelect:function(){var e=this.is("selected");this.set("selected",!e)}}),i=e.View.extend({tagName:"li",className:"single-select-item",template:'<a href="#{{id}}" class="action">{{name}}</a>',changeHandler:function(){this.render(),this.$el.toggleClass("active",this.model.is("selected"))}}),s=e.Collection.extend({model:r}),o=[a],u=e.Model.extend({constructor:function(t){var n=this;e.Model.call(n,t),_.each(o,function(e){e(n,{})})}});return{View:n,Model:u,ItemModel:r,ItemView:i,ItemCollection:s}}),define("list/multiSelect",["base","list/singleSelect"],function(e,t){function i(e,n){n.selected=[],n.coll=e.get("items"),n.coll||(n.coll=new t.ItemCollection,e.set("items",n.coll)),e.getSelected=function(){return n.selected},e.setSelectedById=function(t){var r=n.coll.get(t);r.toggleSelect(),e.updateSelected()},e.setSelected=function(t){t.toggleSelect(),e.updateSelected()},e.selectAll=function(){n.coll.each(function(e){e.select()}),e.updateSelected()},e.selectNone=function(){n.coll.each(function(e){e.deselect()}),e.updateSelected()},e.updateSelected=function(){n.selected=n.coll.where({selected:!0}),e.set("selectedCount",n.selected.length)},e.updateSelected()}var n=[i],r=e.Model.extend({constructor:function(t){var r=this;e.Model.call(r,t),_.each(n,function(e){e(r,{})})}});return{View:t.View,Model:r,ItemView:t.ItemView,ItemCollection:t.ItemCollection}}),define("list",["require","list/singleSelect","list/multiSelect"],function(e){return{SingleSelect:e("list/singleSelect"),MultiSelect:e("list/multiSelect")}}),define("text!widgets/messageStack/messageStack.html",[],function(){return'<ul class="alert-list ">\n\n</ul>\n<ul class="warning-list">\n\n</ul>\n\n<ul class="success-list">\n\n</ul>\n\n<ul class="failure-list">\n\n</ul>'}),define("widgets/messageStack",["base/app","base","list","text!./messageStack/messageStack.html"],function(e,t,n,r){var i=t.util,s=t.Model.extend({initialize:function(){var e=_.bind(this.removeMessage,this),t=new a;t.on("add",function(t){var n=t.get("expires");switch(n){case-1:t.removeSelf();break;case 0:break;default:_.delay(e,n*1e3,t)}}),this.messageCollection=t},addMessage:function(e){var t=this;e.ts=(new Date).getTime(),t.messageCollection.add(e)},removeMessage:function(e){this.messageCollection.remove(e)},removeAllMessages:function(){var e=this,t=e.messageCollection.pluck("ts");_.each(t,function(t){var n=e.messageCollection.get(t);n.removeSelf()})}}),o=t.Model.extend({defaults:{expires:10,isClosable:!1,messageType:"alert"},idAttribute:"ts"}),u=t.View.extend({tagName:"li",className:"alert",template:e.compileTemplate('{{#if isClosable}}<button type="button" class="close remove_message" >&times;</button>{{/if}}{{{message}}}'),events:{"click .remove_message":"removeMessage"},removeMessage:function(){this.model.removeSelf()},postRender:function(){var e=this.model.get("messageType"),t="alert-danger";switch(e){case"warning":t="alert-warning";break;case"success":t="alert-success"}this.$el.addClass(t)}}),a=t.Collection.extend({model:o}),f=t.View.extend({initialize:function(){this.viewIndex={},this.model||(this.model=new s);var e=this.model.messageCollection;this.listenTo(e,"add remove",this.checkEmpty),this.listenTo(e,"add",this.addMessage),this.listenTo(e,"remove",this.removeMessage)},template:r,checkEmpty:function(){var e=this.model.messageCollection;e.length===0?this.$el.addClass("hide"):this.$el.removeClass("hide")},addMessage:function(e){e.toJSON||(e=new o(e));var t=e.toJSON(),n=i.createView({View:u,parentEl:"."+t.messageType+"-list",parentView:this,model:e});this.viewIndex[e.id]=n},removeMessage:function(e){var t=this.viewIndex[e.id];this.viewIndex[e.id]=null,t.remove()}});return{View:f,Model:s,MessageCollection:a}}),define("text!widgets/form/checkListView.html",[],function(){return'<div class="form-group">\n    <label>{{elementLabel this}}</label>\n    <div class="controls">\n        {{#each options}}\n        <label class="checkbox-inline">\n            <input type="checkbox" name="{{id}}" value="{{id}}" class="js-validate-change"> {{name}}\n        </label>\n        {{/each}}\n        <span class="message-block"></span>\n    </div>\n</div>'}),define("text!widgets/form/checkBoxView.html",[],function(){return'<div class="form-group">\n    <div class="controls">\n        <label class="checkbox-inline">\n            <input type="checkbox" name="{{id}}" value="{{id}}" class="js-validate-change"> {{elementLabel this}}\n        </label>\n        <span class="message-block"></span>\n    </div>\n</div>'}),define("text!widgets/form/radioListView.html",[],function(){return'<div class="form-group">\n    <label>{{elementLabel this}}</label>\n    <div class="controls">\n        {{#each options}}\n        <label class="radio-inline">\n            <input type="radio" name="{{../name}}" value="{{id}}"  class="el-{{name}} js-validate-change" > {{name}}\n        </label>\n        {{/each}}\n        <span class="message-block"></span>\n    </div>\n</div>'}),define("text!widgets/form/selectView.html",[],function(){return'<div class="form-group ">\n    <label>{{elementLabel this}}</label>\n    <div class="controls kensho-select">\n        <select name="{{name}}" class="el-{{name}} form-control js-validate-change">\n            {{#each options}}\n            <option value="{{id}}">{{name}}</option>\n            {{/each}}\n        </select>\n        <span class="message-block"></span>\n    </div>\n</div>'}),define("text!widgets/form/textAreaView.html",[],function(){return'<div class="form-group">\n    <label>{{elementLabel this}}</label>\n    <div class="controls">\n        <textarea type="{{type}}" name="{{name}}" class="el-{{name}} form-control  js-update-change js-validate-change">{{value}}</textarea>\n        <span class="message-block"></span>\n    </div>\n</div>'}),define("text!widgets/form/buttonView.html",[],function(){return'<div class="form-group">\n    <div class="controls">\n        <button class="{{buttonClass this}}" type="{{buttonType this}}">{{value}}</button>\n        <span class="message-block"></span>\n    </div>\n</div>'}),define("text!widgets/form/messageView.html",[],function(){return'<div class="control-group">\n    <div class="message">{{value}}\n    </div>\n</div>'}),define("widgets/form",["base/app","base/util","base","widgets/form/element","widgets/messageStack","text!./form/checkListView.html","text!./form/checkBoxView.html","text!./form/radioListView.html","text!./form/selectView.html","text!./form/textAreaView.html","text!./form/buttonView.html","text!./form/messageView.html"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=r.View,p=r.Model,d=r.Collection,v=h.extend({template:l,valueFunction:function(){return this.$("button").text()},valueChangeHandler:function(e){this.$("button").text(e)},activeChangeHandler:function(e){this.$("button").prop("disabled",!e)}}),m=h.extend({template:o,valueFunction:function(){return this.$("input").is(":checked")},valueChangeHandler:function(e){this.$("input").attr("checked",e)}}),g=h.extend({template:f,valueFunction:function(){return this.$("textarea").val()},valueChangeHandler:function(e){this.$("textarea").val(e)}}),y=h.extend({template:a,valueFunction:function(){return this.$("select").val()},valueChangeHandler:function(e){this.$("select").val(e)},disabledChangeHandler:function(e){this.$el.toggleClass("disabled",e),this.$("select").attr("disabled",e)}}),b=h.extend({template:u,valueFunction:function(){return this.$("input:checked").val()},valueChangeHandler:function(e){this.$("input[value="+e+"]").attr("checked",!0)}}),w=h.extend({template:s,valueFunction:function(){var e=this.$("input:checked"),t=_.map(e,function(e){return $(e).val()});return t},valueChangeHandler:function(e){_.isArray(e)&&_.each(e,function(e){this.$("input[value="+e+"]").attr("checked",!0)},this)}}),E=h.extend({template:'<input type="hidden" value="{{value}}" name="{{name}}" />',valueChangeHandler:function(e){this.$("input").val(e),this.$("input").trigger("change")},valueFunction:function(){return""+this.$("input").val()}}),S=h.extend({template:" ",valueChangeHandler:function(e){},valueFunction:function(){}}),x=h.extend({selectIfDefault:function(){this.model.isElementDefault()&&this.$("input").select()},clearIfDefault:function(){this.model.isElementDefault()&&this.$("input").val("")},resetIfEmpty:function(){var e=this.$("input").val();if(e===""){var t=this.model.toJSON();t.defaultValue&&this.$("input").val(t.defaultValue)}this.updateValue()}}),T=h.extend({template:c,valueChangeHandler:function(e){this.$(".message").html(e)},valueFunction:function(){return this.$(".message").html()}}),N=h.extend({template:'<input type="hidden" value="{{value}}" name="{{name}}" />',valueChangeHandler:function(e){this.$("input").val(JSON.stringify(e)),this.updateValue()},valueFunction:function(){return JSON.parse(this.$("input").val())}}),C=h.extend({valueFunction:function(){return this.$("input").is(":checked")},valueChangeHandler:function(e){this.$("input").attr("checked",e)}}),k={select:y,textarea:g,checkbox:m,radioList:b,checkList:w,hidden:E,json:N,button:v,message:T,container:S},L=function(e){return k[e]||x},A=function(e,t){k[e]=t},O=function(e){k=_.extend({},k,e)},M=n.Model.extend({constructor:function(){n.Model.apply(this,arguments)},defaults:{elements:new d},setElementAttribute:function(e,t,n){var r=this.get("elements");r.get(e).set(t,n)},getValueObject:function(){var e=this.get("elements");e.each(function(e){e.trigger("forceUpdate")});var t=this.validateElements(),n={};return t.length===0?e.each(function(e){e.is("active")&&e.isNotEqual("type","button")&&(n[e.id]=e.get("value"))}):n.errors=t,n},validateElements:function(){var e=this.get("elements"),t=[];return e.each(function(e){t=t.concat(e.isElementValid())}),t},elementsChangeHandler:function(){var e=this.get("elements");e.on("change",function(e){var t="change",n=Array.prototype.slice.call(arguments,[0]);n[0]="elements:"+t,this.trigger.apply(this,n),n[0]="elements:"+e.get("name")+":"+t,this.trigger.apply(this,n)},this)}}),D="grp-",P=n.View.extend({constructor:function(e){this.typeViewIndex={},n.View.apply(this,arguments)},tagName:"div",className:"form-view",events:{"submit form":"formSubmitHandler"},template:'<div class="message-stack"></div><form action="{{actionId}}" class="form-vertical" method=""> <div class="group-list"></div> <div class="grp-buttons"> </div> </form>',postRender:function(){this.formEl=this.$("form"),this.renderGroupContainers(),this.renderMessageStack();var e=this.model,t=e.get("elements");t.each(function(e){this.addElement(e)},this)},addElement:function(e){var n=e.toJSON(),r=this,i=this.typeViewIndex[n.type]||L(n.type),s=n.name,o,u=this.$(".element-"+s);if(u.length!==0)o=new i({model:e,el:u}),o.postRender(),o.syncAttributes();else{o=t.createView({View:i,model:e,parentView:r});var a=n.group;this.$("."+D+a).append(o.render().el)}},removeElement:function(e){},renderGroupContainers:function(){var e=this.model,t=e.get("elements"),n=_.unique(t.pluck("group")),r=this.$(".group-list");_.each(n,function(e){this.$("."+D+e).length===0&&r.append('<div class="'+D+e+'"></div>')},this)},renderMessageStack:function(){var e=t.createView({View:i.View,Model:i.Model,parentEl:".message-stack",parentView:this}),n=e.model;e.listenTo(this,"showMessages",function(e){n.removeAllMessages(),_.each(e,function(e){var t=new i.Model(e);n.addMessage(t.toJSON())})}),e.listenTo(this,"clearMessages",function(){n.removeAllMessages()});var r=this.model.get("errors");r&&r.length>0&&this.trigger("showMessages",r)},formSubmitHandler:function(e){e.preventDefault(),this.trigger("clearMessages");var t=this.model.getValueObject(),n=this.model.get("actionId");this.options.prePostParser&&(t=this.options.prePostParser(t)),this.trigger("formSubmit",t)},addToTypeViewIndex:function(e,t){this.typeViewIndex[e]=t},submitSuccessHandler:function(){console.log(arguments)},submitFailureHandler:function(e,t){_.each(t,function(e){e.messageType="failure",e.expires=0}),this.trigger("showMessages",t)},setElementValue:function(e,t){var n=this.model.get("elements");n.get(e).set("value",t)},resetForm:function(e){var t=this.model.get("elements");t.each(function(e){e.resetValue(!0)}),e&&this.trigger("clearMessages")}});return P.addToTypeViewIndex=function(e,t){A(e,t)},{Model:M,View:P,ElementModel:p,ElementCollection:d,ElementView:h}}),define("base-list-idm",["require","widgets/form","widgets/header","widgets/messageStack"],function(e){return{Form:e("widgets/form"),Header:e("widgets/header"),MessageStack:e("widgets/messageStack")}});