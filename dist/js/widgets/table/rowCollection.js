define(["base/app","base/util","base/model","base/collection"],function(e,t,n,r){var i=r.extend({constructor:function(){var e=this;r.apply(e,arguments),_.each(a,function(t){t(e)})},configDefaults:{sortOrder:"asc",perPage:5},configHandler:function(e){(_.has(e,"sortKey")||_.has(e,"sortOrder"))&&this.setConfig("page",1)},isLocal:function(){var e=this.getConfig("requestId"),t=this.url;return e&&t?!1:!0}}),s=function(e){e.setSortKey=function(t){var n=e.getConfigs(),r="asc";t===n.sortKey?(r=n.sortOrder==="asc"?"desc":"asc",e.setConfigs({sortOrder:r})):e.setConfigs({sortKey:t,sortOrder:r})},e.getSorted=function(){var t=e.getConfigs(),n=e.sortBy(t.sortKey);return t.sortOrder!=="asc"&&n.reverse(),n}},o=function(t){var n={};t.addFilter=function(t){var r=e.getHash(JSON.stringify(t));n[r]=t},t.removeFilter=function(t){var r=e.getHash(t),i=n[r];if(!i)throw new Error("Filter missing");delete n[r]},t.getFiltered=function(e){var t=_.values(n);return t.length===0?e:_.filter(e,function(e){return e.checkFilters(t)})},t.getProcessedRecords=function(){var e=t.getConfigs(),n;if(e.requestId||t.url)n=t.toArray();else{var r=t.getFiltered(t.getSorted(t));t.setConfig("totalRecords",r.length),n=t.getPaginated(r)}return n},t.processedEach=function(e,n){var r=t.getProcessedRecords();_.each(r,function(r,i){e.call(n||t,r,i)})}},u=function(e){var t=e.getConfigs();e.getPaginated=function(n){return t=e.getConfigs(),t.paginated?n.splice((t.page-1)*t.perPage,t.perPage):n},e.nextPage=function(){var t=e.getConfigs(),n=Math.ceil(t.totalRecords/t.perPage),r=e.getConfig("page");e.setConfig("page",Math.min(r+1,n))},e.prevPage=function(){var t=e.getConfig("page");e.setConfig("page",Math.max(1,t-1))}},a=[o,s,u];return i});