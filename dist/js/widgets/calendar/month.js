define(["base"],function(e){var t=e.app.compileTemplate('<td><a href="#selectDate" data-date="{{date}}" data-month="{{month}}" data-year="{{year}}" class="day action {{#if isToday}}today{{/if}} {{#if isSelected}}selected{{/if}}{{#if isDisabled}}disabled{{/if}}">{{date}}</a> </td>'),n=e.View.extend({className:"month",template:'<a href="#prevMonth" class="action but-prev"> < </a><div class="month-name">{{monthName month}}-{{year}}</div> <a href="#nextMonth" class="action but-next"> > </a> ',postRender:function(){var e=$("<table></table>"),n=this.model.toJSON(),r=this.getDate().startOf("week"),i=0,s,o=!1,u=!1,a=!1,f=moment().startOf("day").valueOf(),l=n.selectedEpoch;while(i<42){var c=r.day();c===0&&(s=$("<tr></tr>"),e.append(s)),r.valueOf()===f?o=!0:o=!1,r.valueOf()===l?u=!0:u=!1,r.month()!==n.month?a=!0:a=!1,s.append(t({date:r.date(),month:r.month(),year:r.year(),isToday:o,isSelected:u,isDisabled:a})),r.add("days",1),i++}this.$el.append(e)},getDate:function(){var e=this.model.toJSON();return moment({y:e.year,M:e.month,d:1})},changeHandler:function(){this.render()},actionHandler:function(e,t){switch(e){case"prevMonth":var n=this.getDate();n.add("months",-1),this.model.set({month:n.month(),year:n.year()});break;case"nextMonth":var n=this.getDate();n.add("months",1),this.model.set({month:n.month(),year:n.year()});break;case"selectDate":var r=$(t.target),i=r.data(),n=moment({y:i.year,M:i.month,d:i.date});this.model.set("selectedEpoch",n.valueOf()),this.trigger("dateClicked",n);break;default:alert("unhandled action: "+e)}}}),r=e.Model.extend({defaults:{month:moment().month(),year:moment().year(),selectedEpoch:moment().startOf("day").valueOf()}});return{View:n,Model:r}});